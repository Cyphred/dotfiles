# !/bin/sh

# Prints number of all tasks, and overdue ones.
# Total number of tasks has emoji ğŸ“‹
# Number of overdue tasks has emoji âŒ›

tasks=$(task list | awk 'END {print $(NF-1)}')
if [ ! -z "$tasks" ]; then
	output+="$tasks"

	# Tasks due today
	dueToday=$(task overdue | grep $(date +%Y-%m-%d) | wc -l)
	[ -z "$dueToday" ] && dueToday=0 || output+=" âŒ›$dueToday"

	# Overdue tasks
	overdue=$(task overdue | awk 'END {print $(NF-1)}')
	[ -z "$overdue" ] && overdue=0 || let overdue=$overdue-$dueToday && output+=" ğŸ”´$overdue"
else
	output=0
	tasks=0
	overdue=0
	dueToday=0
fi

printf "ğŸ“‹$output\n"

case $BLOCK_BUTTON in
	3) notify-send "ğŸ“‹ Task module" "ğŸ“‹ $tasks tasks
âŒ› $dueToday tasks due today
ğŸ”´ $overdue tasks overdue" ;;
esac
